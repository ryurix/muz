<h3>Подключение</h3>
<p>Подключаться следует на адрес сайта, например: <?= \Config::DOMAIN ?>/api/order, можно использовать GET или POST запросы.</p>
<h3>Авторизация</h3>
<p>Для авторизации нужно передавать в заголовке запроса параметр Authorization со значением Bearer &lt;token&gt;</p>
<p>Пример: Authorization: Bearer nokiosqgondsqb2021358s6u75de6ibs</p>
<p>Текущие валидные токены:</p>
<?

$keys = \Db::fetchAll('SELECT * FROM session WHERE usr='.\User::id());
foreach ($keys as $i) {
	\Flydom\Alert::warning($i['id']);
}

w('alert');

?>

<h3>Получение токена через API</h3>
<p><b>/api/token</b></p>
<p>Для получения токена необходимо передать POST запрос с логином (_login) и паролем (_password) пользователя. Пример:</p>
<pre>
POST <?= \Config::DOMAIN ?>/api/token
Content-Type: application/x-www-form-urlencoded

_login=user@mail.ru&_password=1234567
</pre>
<p>Пользователь должен иметь право на доступ к API и разделам к которым будут делаться запросы.</p>
<p>Время жизни токена не ограничено. Но если пользователь изменится &mdash; его токены будут сброшены.</p>

<h3>Получение последнего необработанного заказа</h3>
<p><b>/api/order</b></p>
<p>В ответе будет json заказа.</p>
<p>Можно передать параметр limit &mdash; тогда будут возвращено не более указанного количества заказов.</p>
<p>Можно передать для фильтрации параметры: mark, state, staff, user</p>

<h3>Получение заказа по идентификатору</h3>
<p><b>/api/order/{id}</b></p>
<p>Вместо {id} нужно указать идентификатор заказа.</p>
<p>В ответе будет json заказа.</p>

<h3>Добавление данных в заказ</h3>
<p><b>/api/order/add</b></p>
<p>В ответе будет "ok" если успешно или текст ошибки.</p>
<p>Лучше всего передавать методом PUT, json с указанием идентификатора заказа и данными которые надо добавить.</p>
<p>Данные будут добавлены к имеющимся</p>
<p>Пример: {
	'id':344715,
	'note': 'замечания для менеджера',
	'info': 'информация для клиента',
	'mark': 12
}</p>

<h3>Изменение данных в заказе</h3>
<p><b>/api/order/edit</b></p>
<p>В ответе будет "ok" если успешно или текст ошибки.</p>
<p>Лучше всего передавать методом PUT, json с указанием идентификатора заказа и данными которые надо изменить.</p>
<p>Данные будут добавлены к имеющимся</p>
<p>Пример: {
	'id':344715,
	'staff': 123,
	'state': 10,
	'vendor': 33,
	'note': 'замечания для менеджера',
	'info': 'информация для клиента'
}</p>