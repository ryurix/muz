<?

set_time_limit(\Config::TIME_LIMIT);

$all = array();
foreach (glob("files/catalog/*") as $i) {
	$all[] = '/'.$i;
}

//print_pre($all);

$list = array();

$q = db_query("SELECT * FROM catalog");
while ($i = db_fetch($q)) {
	if (strlen($i['icon'])) {
		$list[] = $i['icon'];
	}
}
db_close($q);

$del = array_diff($all, $list);

echo '<p>'.count($all).' = '.count($list).' - '.count($del).'</p>';

foreach ($del as $i) {
	unlink(\Config::ROOT.substr($i, 1));
}

//print_pre($list);